<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#080c10">
  <title>Acoustic Field Pro — Professional Audio Analyzer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="app">

  <!-- ====================================================================
       HEADER
       ==================================================================== -->
  <header id="header">
    <div class="brand">
      <div class="brand-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
      </div>
      <div>
        <div class="brand-name">Acoustic Field Pro</div>
        <div class="brand-sub">OrdoAudio DSP Engine v2.0</div>
      </div>
    </div>

    <div class="header-controls">
      <div class="status-pills">
        <div id="pill-status" class="status-pill">
          <span id="led-status" class="led"></span>
          <span id="pill-status-label">STANDBY</span>
        </div>
        <div id="pill-clip" class="status-pill">
          <span id="led-clip" class="led"></span>
          <span>CLIP</span>
        </div>
        <div id="pill-fdbk" class="status-pill">
          <span id="led-fdbk" class="led"></span>
          <span>FDBK</span>
        </div>
        <div id="pill-tp" class="status-pill">
          <span id="led-tp" class="led"></span>
          <span>TP</span>
        </div>
        <div id="pill-rec" class="status-pill">
          <span id="led-rec" class="led"></span>
          <span id="rec-timer">REC</span>
        </div>
      </div>
      <button id="power-btn">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
        <span id="power-btn-text">INIT ENG</span>
      </button>
    </div>
  </header>

  <!-- ====================================================================
       MAIN GRID
       ==================================================================== -->
  <main id="main">

    <!-- === METRICS ROW === -->
    <div id="metrics-row">
      <div class="metric-card">
        <div class="metric-label">RMS Level</div>
        <div><span id="val-level" class="metric-value">-∞</span><span class="metric-unit">dBFS</span></div>
        <div class="level-bar-wrap"><div id="meter-level" class="level-bar"></div></div>
        <div class="metric-sub">Peak hold: <span id="val-peak">-∞</span> dB</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Pitch (YIN)</div>
        <div><span id="val-freq" class="metric-value">--</span><span class="metric-unit">Hz</span></div>
        <div style="display:flex;align-items:baseline;gap:6px;margin-top:3px;">
          <span id="val-note" style="font-family:var(--font-display);font-size:18px;font-weight:700;color:var(--green)">--</span>
          <span id="val-note-detail" style="font-family:var(--font-mono);font-size:10px;color:var(--text-dim)"></span>
        </div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Tempo / BPM</div>
        <div><span id="val-bpm" class="metric-value">--</span><span class="metric-unit">bpm</span></div>
        <div id="val-bpm-conf" class="metric-sub">tracking...</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Est. Key</div>
        <div style="display:flex;align-items:baseline;gap:6px;">
          <span id="val-key" class="metric-value">--</span>
          <span id="val-key-mode" class="metric-unit" style="color:var(--text-dim)">--</span>
        </div>
        <div class="metric-sub">Chromagram analysis</div>
      </div>
    </div>

    <!-- === RTA PANEL === -->
    <div id="rta-panel" class="panel">
      <div class="panel-header">
        <span class="panel-title">Real-Time Analyzer — 1/3 Octave ISO</span>
        <div style="display:flex;align-items:center;gap:6px;">
          <button id="rta-aweight-btn" class="tool-btn" title="Toggle A-Weighting">A-WT</button>
          <div class="tool-btn-group">
            <button class="win-btn active" data-win="hann"        title="Hann window">HANN</button>
            <button class="win-btn"        data-win="blackman"    title="Blackman window">BLK</button>
            <button class="win-btn"        data-win="flattop"     title="Flat-Top (best amplitude accuracy)">FLAT</button>
            <button class="win-btn"        data-win="rectangular" title="Rectangular window">RECT</button>
          </div>
          <button id="rta-snapshot-btn" class="tool-btn" title="Save RTA as PNG">⬇ PNG</button>
        </div>
      </div>
      <div id="rta-canvas-wrap">
        <canvas id="rta-canvas"></canvas>
        <div id="rta-tooltip" class="rta-tooltip"></div>
        <div class="freq-axis">
          <span>20</span><span>63</span><span>125</span><span>250</span>
          <span>500</span><span>1k</span><span>2k</span><span>4k</span>
          <span>8k</span><span>16k</span><span>20k</span>
        </div>
        <div class="db-axis">
          <span>0</span><span>-25</span><span>-50</span><span>-75</span><span>-100</span>
        </div>
      </div>
    </div>

    <!-- === SIDEBAR === -->
    <aside id="sidebar">

      <div class="panel" style="flex:1;overflow:hidden;display:flex;flex-direction:column;">
        <div class="tab-bar">
          <button class="tab-btn active" data-tab="loudness">LOUD</button>
          <button class="tab-btn"        data-tab="spectral">SPEC</button>
          <button class="tab-btn"        data-tab="chroma">CHRO</button>
          <button class="tab-btn"        data-tab="diag">DIAG</button>
          <button class="tab-btn"        data-tab="session">REC</button>
          <button class="tab-btn"        data-tab="tools">TOOLS</button>
        </div>

        <!-- TAB: LOUDNESS -->
        <div id="tab-loudness" class="tab-content active">
          <div class="metric-label" style="margin-bottom:6px;">LUFS (EBU R128 / BS.1770)</div>
          <div class="lufs-bars">
            <div class="lufs-row">
              <span class="lufs-row-label">M</span>
              <div class="lufs-bar-wrap"><div id="bar-lufs-m" class="lufs-bar"></div></div>
              <span id="lufs-m" class="lufs-val">-∞</span>
            </div>
            <div class="lufs-row">
              <span class="lufs-row-label">S</span>
              <div class="lufs-bar-wrap"><div id="bar-lufs-s" class="lufs-bar"></div></div>
              <span id="lufs-s" class="lufs-val">-∞</span>
            </div>
            <div class="lufs-row">
              <span class="lufs-row-label">I</span>
              <div class="lufs-bar-wrap"><div id="bar-lufs-i" class="lufs-bar" style="background:var(--cyan)"></div></div>
              <span id="lufs-i" class="lufs-val">-∞</span>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px;">
            <span class="metric-label" style="margin:0">LRA</span>
            <span id="lufs-lra" class="font-mono text-green" style="font-size:11px;">--</span>
          </div>

          <!-- LUFS History Graph -->
          <div style="margin-top:8px;position:relative;">
            <canvas id="lufs-history-canvas" style="width:100%;height:64px;border:1px solid var(--border);border-radius:4px;display:block;background:var(--bg-surface);"></canvas>
            <div style="display:flex;justify-content:space-between;margin-top:2px;">
              <span class="font-mono" style="font-size:8px;color:var(--text-dim)">-60s</span>
              <span class="font-mono" style="font-size:8px;color:rgba(0,200,255,0.5)">-23 / -18 LUFS targets</span>
              <span class="font-mono" style="font-size:8px;color:var(--text-dim)">now</span>
            </div>
          </div>

          <hr class="divider">

          <div class="metric-label" style="margin-bottom:6px;">True Peak & Dynamics</div>
          <div class="diag-grid">
            <div class="diag-cell">
              <div class="diag-cell-label">True Peak</div>
              <div id="true-peak-val" class="diag-cell-value">-∞<span style="font-size:8px;color:var(--text-dim)">dBTP</span></div>
              <span id="led-tp-inline" class="led" style="margin-top:4px;display:block;"></span>
            </div>
            <div class="diag-cell">
              <div class="diag-cell-label">Crest Factor</div>
              <div id="crest-val" class="diag-cell-value">--<span style="font-size:8px;color:var(--text-dim)">dB</span></div>
            </div>
            <div class="diag-cell">
              <div class="diag-cell-label">Dyn Range</div>
              <div id="dr-val" class="diag-cell-value">--<span style="font-size:8px;color:var(--text-dim)">dB</span></div>
            </div>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px;">
            <span class="metric-label" style="margin:0">Compression Est.</span>
            <span id="compr-val" class="font-mono" style="font-size:11px;color:var(--text-dim)">--</span>
          </div>

          <hr class="divider">

          <div class="metric-label" style="margin-bottom:6px;">Energy Distribution</div>
          <div class="eq-bars">
            <div class="eq-col"><div class="eq-bar-bg"><div id="bar-low" class="eq-bar low"></div></div><span class="eq-label">LOW</span></div>
            <div class="eq-col"><div class="eq-bar-bg"><div id="bar-mid" class="eq-bar mid"></div></div><span class="eq-label">MID</span></div>
            <div class="eq-col"><div class="eq-bar-bg"><div id="bar-high" class="eq-bar high"></div></div><span class="eq-label">HIGH</span></div>
          </div>
        </div><!-- /tab-loudness -->

        <!-- TAB: SPECTRAL -->
        <div id="tab-spectral" class="tab-content">
          <div class="metric-label" style="margin-bottom:8px;">Spectral Features</div>
          <div class="diag-grid" style="grid-template-columns:repeat(2,1fr);">
            <div class="diag-cell"><div class="diag-cell-label">Centroid</div><div id="centroid-val" class="diag-cell-value" style="font-size:12px;">--</div></div>
            <div class="diag-cell"><div class="diag-cell-label">Flatness</div><div id="flatness-val" class="diag-cell-value" style="font-size:12px;">--</div></div>
            <div class="diag-cell"><div class="diag-cell-label">Rolloff</div><div id="rolloff-val" class="diag-cell-value" style="font-size:12px;">--</div></div>
            <div class="diag-cell"><div class="diag-cell-label">Bandwidth</div><div id="bandwidth-val" class="diag-cell-value" style="font-size:12px;">--</div></div>
          </div>
          <hr class="divider">
          <div style="display:flex;align-items:baseline;gap:8px;margin-bottom:6px;">
            <span class="metric-label" style="margin:0">THD</span>
            <span id="thd-val" class="metric-value" style="font-size:16px;">--</span>
          </div>
          <div class="harmonic-bars">
            <div class="harmonic-col"><div class="harmonic-bar-bg"><div class="harmonic-bar"></div></div><span class="harmonic-n">H2</span></div>
            <div class="harmonic-col"><div class="harmonic-bar-bg"><div class="harmonic-bar"></div></div><span class="harmonic-n">H3</span></div>
            <div class="harmonic-col"><div class="harmonic-bar-bg"><div class="harmonic-bar"></div></div><span class="harmonic-n">H4</span></div>
            <div class="harmonic-col"><div class="harmonic-bar-bg"><div class="harmonic-bar"></div></div><span class="harmonic-n">H5</span></div>
            <div class="harmonic-col"><div class="harmonic-bar-bg"><div class="harmonic-bar"></div></div><span class="harmonic-n">H6</span></div>
            <div class="harmonic-col"><div class="harmonic-bar-bg"><div class="harmonic-bar"></div></div><span class="harmonic-n">H7</span></div>
            <div class="harmonic-col"><div class="harmonic-bar-bg"><div class="harmonic-bar"></div></div><span class="harmonic-n">H8</span></div>
          </div>
          <hr class="divider">
          <div class="metric-label" style="margin-bottom:6px;">MFCC (Timbre Fingerprint)</div>
          <div class="mfcc-grid">
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
            <div class="mfcc-bar-wrap"><div class="mfcc-bar"></div></div>
          </div>
        </div><!-- /tab-spectral -->

        <!-- TAB: CHROMA -->
        <div id="tab-chroma" class="tab-content">
          <div class="metric-label" style="margin-bottom:6px;">Chromagram (12 Pitch Classes)</div>
          <div class="chroma-grid">
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">C</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">C#</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">D</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">D#</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">E</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">F</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">F#</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">G</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">G#</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">A</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">A#</span></div>
            <div class="chroma-bar-wrap"><div class="chroma-bar-bg"><div class="chroma-bar"></div></div><span class="chroma-label">B</span></div>
          </div>
          <hr class="divider">
          <div class="metric-label" style="margin-bottom:6px;">Phase Correlation</div>
          <div class="phase-meter-wrap">
            <div id="phase-needle" class="phase-needle" style="left:100%"></div>
          </div>
          <div class="phase-labels">
            <span>-1 Anti-Phase</span><span>0</span><span>+1 Mono</span>
          </div>
          <div style="display:flex;justify-content:space-between;margin-top:6px;">
            <span id="phase-str" class="font-mono" style="font-size:11px;color:var(--text-dim)">--</span>
            <span id="phase-corr" class="font-mono" style="font-size:11px;color:var(--text-dim)">--</span>
          </div>
          <hr class="divider">
          <div style="display:flex;align-items:baseline;gap:8px;margin-bottom:4px;">
            <span class="metric-label" style="margin:0">RT60 Reverb Time</span>
            <span id="rt60-val" class="font-mono" style="font-size:12px;color:var(--cyan)">Measuring...</span>
          </div>
          <div class="metric-sub">Time for decay of 60 dB after source stops</div>
        </div><!-- /tab-chroma -->

        <!-- TAB: DIAGNOSTICS -->
        <div id="tab-diag" class="tab-content">
          <div style="display:flex;align-items:baseline;gap:8px;margin-bottom:6px;">
            <span class="metric-label" style="margin:0">Signal / Noise Ratio</span>
            <span id="snr-val" class="font-display" style="font-size:16px;font-weight:700;color:var(--green)">--</span>
          </div>
          <div style="display:flex;justify-content:space-between;">
            <span class="metric-sub">Noise floor:</span>
            <span id="noise-floor" class="font-mono" style="font-size:10px;color:var(--text-dim)">--</span>
          </div>
          <hr class="divider">
          <div class="diag-grid" style="grid-template-columns:repeat(2,1fr);margin-bottom:0;">
            <div class="diag-cell">
              <div class="diag-cell-label">ZCR</div>
              <div id="zcr-val" class="diag-cell-value" style="font-size:12px;">--</div>
              <div id="zcr-type" class="diag-cell-label" style="margin-top:2px;color:var(--text-dim)">--</div>
            </div>
            <div class="diag-cell">
              <div class="diag-cell-label">DC Offset</div>
              <div id="dc-val" class="diag-cell-value" style="font-size:12px;">--</div>
              <div id="dc-severity" class="metric-value" style="font-size:10px;margin-top:2px;">--</div>
            </div>
          </div>
          <hr class="divider">
          <div class="metric-label" style="margin-bottom:6px;">Room Modes (20–300 Hz)</div>
          <div id="modes-container" class="mode-list">
            <div class="font-mono" style="font-size:10px;padding:4px;color:var(--text-dim)">Start engine to detect</div>
          </div>
        </div><!-- /tab-diag -->

        <!-- TAB: SESSION / RECORDING -->
        <div id="tab-session" class="tab-content">

          <!-- Audio Recording -->
          <div class="metric-label" style="margin-bottom:8px;">Audio Recording</div>
          <button id="session-rec-btn" class="big-btn">
            <span id="session-rec-icon">⏺</span>
            <span id="session-rec-label">Start Recording</span>
          </button>
          <div id="session-rec-status" class="metric-sub" style="margin-top:4px;text-align:center;">Ready — saves as .webm</div>

          <hr class="divider">

          <!-- Metric Logging -->
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
            <div class="metric-label" style="margin:0">Metric Logger</div>
            <div style="display:flex;gap:6px;">
              <button id="log-toggle-btn" class="tool-btn">START LOG</button>
              <button id="log-reset-btn" class="tool-btn">CLEAR</button>
            </div>
          </div>
          <div class="diag-grid" style="grid-template-columns:repeat(2,1fr);margin-bottom:8px;">
            <div class="diag-cell">
              <div class="diag-cell-label">Log Entries</div>
              <div id="log-count" class="diag-cell-value" style="font-size:14px;">0</div>
            </div>
            <div class="diag-cell">
              <div class="diag-cell-label">Events</div>
              <div id="event-count" class="diag-cell-value" style="font-size:14px;">0</div>
            </div>
          </div>

          <!-- Event Log -->
          <div class="metric-label" style="margin-bottom:4px;">Event Log</div>
          <div id="event-log" class="event-log-box"></div>

          <hr class="divider">

          <!-- Exports -->
          <div class="metric-label" style="margin-bottom:8px;">Export</div>
          <div style="display:flex;flex-direction:column;gap:6px;">
            <button id="export-csv-btn"    class="export-btn">⬇ CSV — Metric Log</button>
            <button id="export-report-btn" class="export-btn">⬇ HTML — Session Report</button>
            <button id="export-rta-btn"    class="export-btn">⬇ PNG — RTA Snapshot</button>
          </div>

          <hr class="divider">

          <!-- Session Stats Summary -->
          <div class="metric-label" style="margin-bottom:6px;">Session Stats</div>
          <div class="diag-grid" style="grid-template-columns:repeat(2,1fr);">
            <div class="diag-cell"><div class="diag-cell-label">Duration</div><div id="stat-dur" class="diag-cell-value" style="font-size:12px;">--</div></div>
            <div class="diag-cell"><div class="diag-cell-label">Peak dBFS</div><div id="stat-peak" class="diag-cell-value" style="font-size:12px;">--</div></div>
            <div class="diag-cell"><div class="diag-cell-label">Avg LUFS</div><div id="stat-lufs-avg" class="diag-cell-value" style="font-size:12px;">--</div></div>
            <div class="diag-cell"><div class="diag-cell-label">Clip Events</div><div id="stat-clips" class="diag-cell-value" style="font-size:12px;">0</div></div>
          </div>
        </div><!-- /tab-session -->

        <!-- TAB: TOOLS -->
        <div id="tab-tools" class="tab-content">

          <!-- Test Tone Generator -->
          <div class="metric-label" style="margin-bottom:8px;">Test Tone Generator</div>
          <div class="tone-btn-group">
            <button class="tone-btn active" data-tone="off">OFF</button>
            <button class="tone-btn" data-tone="sine">SINE</button>
            <button class="tone-btn" data-tone="pink">PINK</button>
            <button class="tone-btn" data-tone="white">WHITE</button>
          </div>

          <div id="tone-controls" style="margin-top:10px;opacity:0.4;pointer-events:none;transition:opacity 0.2s;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;">
              <span class="metric-label" style="margin:0">Frequency</span>
              <span id="tone-freq-display" class="font-mono" style="font-size:11px;color:var(--green)">1000 Hz</span>
            </div>
            <input id="tone-freq-slider" type="range" min="20" max="20000" value="1000" step="1" class="range-slider">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;margin-bottom:4px;">
              <span class="metric-label" style="margin:0">Volume</span>
              <span id="tone-vol-display" class="font-mono" style="font-size:11px;color:var(--green)">-20 dB</span>
            </div>
            <input id="tone-vol-slider" type="range" min="-60" max="0" value="-20" step="1" class="range-slider">
          </div>

          <hr class="divider">

          <!-- A-Weighting Toggle -->
          <div class="metric-label" style="margin-bottom:6px;">A-Weighting (RTA Display)</div>
          <div class="tool-btn-group">
            <button id="aw-off-btn" class="win-btn active" data-aw="false">LINEAR</button>
            <button id="aw-on-btn"  class="win-btn"        data-aw="true">A-WEIGHTED</button>
          </div>
          <div class="metric-sub" style="margin-top:6px;">A-weighting matches human loudness perception. Used for noise compliance & SPL measurements.</div>

          <hr class="divider">

          <!-- Window Function Selector -->
          <div class="metric-label" style="margin-bottom:6px;">FFT Window Function</div>
          <div class="tool-btn-group" style="flex-wrap:wrap;">
            <button class="win-btn active" data-win="hann"        title="Hann: best frequency resolution">HANN</button>
            <button class="win-btn"        data-win="blackman"    title="Blackman: low sidelobes">BLACKMAN</button>
            <button class="win-btn"        data-win="flattop"     title="Flat-Top: best amplitude accuracy for THD">FLAT-TOP</button>
            <button class="win-btn"        data-win="rectangular" title="Rectangular: no windowing">RECT</button>
          </div>
          <div id="win-description" class="metric-sub" style="margin-top:6px;">Hann — best balance of frequency resolution and sidelobe rejection.</div>

        </div><!-- /tab-tools -->

      </div><!-- /panel with tabs -->

      <!-- Live Alerts -->
      <div class="panel" style="padding:10px;display:flex;flex-direction:column;gap:6px;flex-shrink:0;">
        <div class="metric-label" style="margin-bottom:2px;">Live Alerts</div>
        <div id="alert-clip" class="alert-box">
          <span class="alert-icon" style="color:var(--red)">⚠</span>
          <div>
            <div class="alert-title" style="color:var(--red)">Clipping Detected</div>
            <div class="alert-detail">Signal exceeds 0 dBFS ceiling</div>
          </div>
        </div>
        <div id="alert-fdbk" class="alert-box">
          <span class="alert-icon" style="color:var(--amber)">⟳</span>
          <div>
            <div class="alert-title" style="color:var(--amber)">Feedback Risk</div>
            <div class="alert-detail"><span id="alert-fdbk-freq">--</span> Hz · Note: <span id="alert-fdbk-note">--</span></div>
          </div>
        </div>
        <div id="alert-dc" class="alert-box">
          <span class="alert-icon" style="color:var(--amber)">⏚</span>
          <div>
            <div class="alert-title" style="color:var(--amber)">DC Offset Detected</div>
            <div class="alert-detail">Check ground / electrical connections</div>
          </div>
        </div>
      </div>

    </aside>

    <!-- === OSCILLOSCOPE === -->
    <div id="osc-panel" class="panel">
      <div class="panel-header">
        <span class="panel-title">Oscilloscope — Time Domain (Zero-Crossing Triggered)</span>
        <span class="panel-badge">WAVEFORM</span>
      </div>
      <div id="osc-canvas-wrap">
        <canvas id="osc-canvas"></canvas>
      </div>
    </div>

    <!-- === SPECTROGRAM === -->
    <div id="spectrogram-panel" class="panel" style="grid-column:1;min-height:90px;">
      <div class="panel-header">
        <span class="panel-title">Spectrogram — Frequency vs Time (Waterfall)</span>
        <span class="panel-badge">LOG FREQ · REAL-TIME</span>
      </div>
      <div id="spectrogram-canvas-wrap" style="flex:1;overflow:hidden;">
        <canvas id="spectrogram-canvas"></canvas>
      </div>
    </div>

  </main>
</div>

<!-- STANDBY OVERLAY -->
<div id="standby-overlay">
  <div class="standby-text">System Standby</div>
  <div class="standby-hint">Press INIT ENG to begin analysis</div>
</div>

<!-- ERROR MODAL -->
<div id="error-modal" role="dialog" aria-modal="true">
  <div class="error-card">
    <h2>
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:inline;margin-right:8px;vertical-align:middle;"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
      Hardware Access Error
    </h2>
    <p id="error-msg">Microphone access is required. Please allow microphone access and try again.</p>
    <button id="error-dismiss">Dismiss</button>
  </div>
</div>

<script src="ordo-audio-lib/ordo-audio.js"></script>
<script src="app.js"></script>
</body>
</html>
